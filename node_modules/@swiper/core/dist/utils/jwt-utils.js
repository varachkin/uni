"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.jwt_decode = jwt_decode;

var _assign2 = _interopRequireDefault(require("lodash/assign"));

var _isString2 = _interopRequireDefault(require("lodash/isString"));

var _isPlainObject2 = _interopRequireDefault(require("lodash/isPlainObject"));

var _jwtDecode = _interopRequireDefault(require("jwt-decode"));

function jwt_decode(jwt_token) {
  if ((0, _isPlainObject2.default)(jwt_token) && (0, _isString2.default)(jwt_token.accessToken)) {
    jwt_token = jwt_token.accessToken;
  }

  const token = {
    rawToken: jwt_token
  };

  try {
    (0, _assign2.default)(token, (0, _jwtDecode.default)(jwt_token));
    if (token.iat) token.issued = new Date(token.iat * 1000);

    if (token.exp) {
      const exp = token.exp * 1000;
      token.expires = new Date(exp);
      Reflect.defineProperty(token, 'expired', {
        get() {
          return Date.now() > exp;
        }

      });
    }

    token.authenticated = Boolean(token.memberId);
    return token;
  } catch (error) {
    return (0, _assign2.default)(token, {
      error
    });
  }
}
//# sourceMappingURL=jwt-utils.js.map